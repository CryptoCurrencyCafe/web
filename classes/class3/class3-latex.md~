% Class 3: Elliptic Curves
% 2014-01-21

## Schedule 

   <div class="todo">
[Project 1](|filename|../../pages/projects/project1/project1.md) is due **Friday, 30 January**.

Before the next class (Monday, Jan 26): 

- **Read:** Satoshi Nakamoto, [_Bitcoin: A Peer-to-Peer Electronic Cash
System_](https://bitcoin.org/bitcoin.pdf), 2008.  The is the original
bitcoin paper, which is quite readable.

- **Read:** [_Chapter 5:
    Transactions_](https://github.com/aantonop/bitcoinbook/blob/develop/ch05.asciidoc)
    from Andreas Antonopoulos' book.
   </div>

<!--
<center> <iframe
src="//www.slideshare.net/slideshow/embed_code/43552674" width="476"
height="400" frameborder="0" marginwidth="0" marginheight="0"
scrolling="no"></iframe><br> 
<div class="caption"> Note: due to a bug in
slideshare's updated player, ink markings no longer appear in the
viewer.  <br>If you download the slides, they are present though.
Hopefully, the player will be fixed someday.  </div>

</center>
-->

### Asymmetric Cryptosystems Recap

For asymmetric cryptography, we need a one-way function with a trapdoor:
a function that can be easily inverted given a secret key, but is hard
to invert without knowledge of that key.

**Signatures:** Signer encrypts a message with her own private key.
  Verifier checks the message using the signer's public key.

## Elliptic Curve Cryptography

**Elliptic curve:** points satisfying an equation like <span
class="math">$y^2 = x^3 + 7$ (this is the curve
used in bitcoin).

For real numbers, this is [easy to solve](http://www.wolframalpha.com/input/?i=y%5E2+%3D+x%5E3+%2B+7):
<span class="math">$y = \sqrt{(x^3 + 7)}$</span>.

In a finite field, it is complex enough to form the basis of cryptographic operations.

## Crash Course in Group Theory

**Group:** A group is a set, <span class="math">_G_</span>, on which the operation <span class="math">$\oplus$</span> is defined with the following properties:

1. _Closure_: for all <span class="math">$a, b \in G$</span>, <span class="math">$a \oplus b \in G$</span>.

2. _Associative_: for all <span class="math">$a, b, c \in G$</span>, <span class="math">$(a \oplus b) \oplus c = a \oplus (b \oplus c)$</span>.

3. _Identity_: there is some element, <span class="math">$0 \in G$</span>, such that for all <span class="math">$a \in G$</span>, <span class="math">$a \oplus 0 = 0 \oplus a = a$<span>.

4. _Inverse_: for all <span class="math">$a \in G$</span>, there exists an inverse, <span class="math">$-a \in G$</span>, such that <span class="math">$a \oplus (-a) = 0$</span>.

**Abelian Group:** An abelian (or commutative) group has this additional property:

- _Commutative_: for all <span class="math">$a, b \in G$</span>, <span class="math">$a \oplus b = b \oplus a$</span>.

Are the integers and addition an abelian group?
<div class="gap">
#
</div>

Are the whole numbers and addition an abelian group?
<div class="gap">
#
</div>

**Finite Field:** A finite field is a set <span class="math">$F$</span> of <span class="math">$N \ge 2$</span> elements on which the operators <span class="math">$\oplus$</span> and <span class="math">&times;</span> are defined with these properties:

1. <span class="math">F</span> is an _abelian group_ with identity <span class="math">0</span> under the <span class="math">$\oplus$</span> operation.  

2. The set <span class="math">$F$ - { 0 }</span> is an _abelian group_ with identity <span class="math">1</span> under the <span class="math">&times;</span> operation.

3. Distributive: For all <span class="math">$a, b, c \in F$</span>, <span class="math">$(a \oplus b) \times c = (a \times c) \oplus (b \times c)$</span>.

(Note that this requires for all <span class="math">$a$</span>, <span class="math">$a \times 0 = 0$</span>.)

**Prime Field Theorem:** For every prime number <span
  class="math">$p$</span>, the set <span class="math">${ 0, 1, ..., p
  - 1 }$</span> forms a finite field with the operations addition and
  multiplication modulo <span class="math">p</span>.

Demonstrate that <span class="math">$F_3$</span> is a finite field.
<div class="gap">
#
#
</div>

See [_Introduction to Finite
Fields_](http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-451-principles-of-digital-communication-ii-spring-2005/lecture-notes/chap7.pdf)
(notes from David Forney's [MIT 6.451
course](http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-451-principles-of-digital-communication-ii-spring-2005/index.htm))
for a proof that all prime fields, <span
class="math">F<sub>p</sub></span> are finite fields, and more thorough
introduction to finite fields.

## Operations on Elliptic Curves

"Addition" on an elliptic curve is done by finding the a point on the
line between the two inputs points, and reflecting that point over the
x-axis.

Doing addition on elliptic curves over finite fields is more complex,
and there has been a lot of research into how to do these operations
efficiently.  See the
[btcec.Add](https://github.com/btcsuite/btcec/blob/master/btcec.go#L431)
code for how it is done in the library.

Doubling (e.g., <span class="math">$P + P = R$</span>) is the same idea,
except instead of finding the intersection of the line formed by the two
addends (which doesn't exist for the single point), finds the
intersection between the tangent of the curve.

"Multiplication" is just repeated addition: <span class="math">$kP = P +
P + ... + P$</span>.

Is there a more efficient way to compute <span class="math">$9P$</span> than using 8 additions?  

\clearpage

## Signing with Elliptic Curves

**Elliptic curve discrete logarithm problem:** given points <span class="math">_P_</span> and <span class="math">_Q_</span>
  on an elliptic curve, it is hard to find an integer <span class="math">_k_</span> such that <span class="math">_Q_ = _kP_</span>.

**Parameters:** curve, _G_ (a point on curve), (large) _n_ such that <span class="math">_nG_ = 0</span>. 

**Key pair: **  
    Private key: <span class="math">_d_</span> = pick a random integer in <span class="math">[1, _n_-1]</span>
    Public key:  point on the curve, <span class="math">_Q_ = _dG_</span>

**Signing:**
  pick random integer <span class="math">_k_</span> in <span class="math">[1, _n_-1]</span>
  compute curve point: <span class="math">(_x_, _y_) = _kG_</span>
  signature = <span class="math">(_x_ mod _n_, _k_<sup>-1</sup>(_z_ + _rd_) mod _n_)</span>

Bitcoin uses the elliptic curve $y^2 = x^3 + 7$ over the prime field, $F_p$ where 
$p = 2^{256} - 2^{32} - 2^9 - 2^8 - 2^7 - 2^6 - 2^4 - 1$.

How should random numbers be generated?
<div class="gap">  
#
</div>

## Dual-EC PRNG 

[NIST Special Publication 800-90A Recommendation for Random Number
Generation Using Deterministic Random Bit
Generators](http://csrc.nist.gov/publications/nistpubs/800-90A/SP800-90A.pdf)


Michael Wertheimer (NSA), [_Encryption and the NSA Role in International
Standards_](http://www.ams.org/notices/201502/rnoti-p165.pdf), Notices
of the American Mathematical Society, February 2015.





